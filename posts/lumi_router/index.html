<!doctype html><html lang=en-us><head><title>Lumi Router JN5169 / xyzroe's blog</title>
<link rel="shortcut icon" href=../../favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.121.1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="xyzroe"><meta name=description content><link rel=stylesheet href=//xyzroe.cc/css/main.min.e936c5013d179081bc7d200f84dcfe9c246ba63f93f7d53028d5ba8329bb286c.css><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-203059197-1","auto"),ga("send","pageview"))</script><meta name=twitter:card content="summary"><meta name=twitter:title content="Lumi Router JN5169"><meta name=twitter:description content="# Lumi Router This is fork of [Lumi Router JN5169 firmware](https://github.com/igo-r/Lumi-Router-JN5169) for use with the LM15-SP-WM module used in the Xiaomi Smart Plug (ZNCZ02LM). Also it can be used with any other JN5169 based module. The only difference is the ability to reset the device using a button on DIO 0. In the original firmware, all control takes place only through the serial port. --- ## How to flash 1."><meta property="og:title" content="Lumi Router JN5169"><meta property="og:description" content="# Lumi Router This is fork of [Lumi Router JN5169 firmware](https://github.com/igo-r/Lumi-Router-JN5169) for use with the LM15-SP-WM module used in the Xiaomi Smart Plug (ZNCZ02LM). Also it can be used with any other JN5169 based module. The only difference is the ability to reset the device using a button on DIO 0. In the original firmware, all control takes place only through the serial port. --- ## How to flash 1."><meta property="og:type" content="article"><meta property="og:url" content="//xyzroe.cc/posts/lumi_router/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-07-07T00:00:00+00:00"><meta property="article:modified_time" content="2021-07-07T00:00:00+00:00"><script src=https://unpkg.com/feather-icons></script><link rel=stylesheet href=../../css/google-translate.css><script src=https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js></script><script src=../../js/google-translate.js></script><link rel=stylesheet href=../../css/accordion.css></head><body><header class=app-header><div class=notranslate><a href=//xyzroe.cc/><img class=app-header-avatar src=../../img/avatar.png alt=xyzroe></a><h1></h1><nav class=app-header-menu><a class=app-header-menu-item href=../../>Home</a>
-
<a class=app-header-menu-item href=../../links/>Links</a>
-
<a class=app-header-menu-item href=../../about/>About</a>
-
<a class=app-header-menu-item href=../../tags/>Tags</a></nav><p>Technical automation, some DIY stuff, little useful scripts, electronic devices development</p><div class=app-header-social><a href=https://t.me/xyzroe target=_blank rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-send"><title>Telergam</title><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></a><a href=mailto:xyzroe@mind.in.ua target=_blank rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-at-sign"><title>Email</title><circle cx="12" cy="12" r="4"/><path d="M16 8v5a3 3 0 006 0v-1a10 10 0 10-3.92 7.94"/></svg></a><a href=https://github.com/xyzroe target=_blank rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>Github</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></div><div class=app-footer><br><a rel="Made in Ukraine" target=_blank href=https://stand-with-ukraine.pp.ua><img alt="Made in Ukraine" style=border-width:0 src="https://img.shields.io/badge/made_in-ukraine-ffd700.svg?labelColor=0057b7"></a><br><br><a rel=license target=_blank href=http://creativecommons.org/licenses/by-sa/4.0/><img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by-sa/4.0/88x31.png></a></div><div class=app-footer>&copy; 2020<script>(new Date).getFullYear()>2010&&document.write(" - "+(new Date).getFullYear())</script></div><div class=language><a href=# alt=EN data-google-lang=en class=language__img>ðŸ‡¬ðŸ‡§</a>
<a href=# alt=UA data-google-lang=uk class=language__img>ðŸ‡ºðŸ‡¦</a>
<a href=# alt=PL data-google-lang=pl class=language__img>ðŸ‡µðŸ‡±</a>
<a href=# alt=IL data-google-lang=iw class=language__img>ðŸ‡®ðŸ‡±</a>
<a href=# alt=DE data-google-lang=de class=language__img>ðŸ‡©ðŸ‡ª</a>
<a href=# alt=FR data-google-lang=fr class=language__img>ðŸ‡«ðŸ‡·</a>
<a href=# alt=ES data-google-lang=es class=language__img>ðŸ‡ªðŸ‡¸</a>
<a href=# alt=IT data-google-lang=it class=language__img>ðŸ‡®ðŸ‡¹</a>
<a href=# alt=NL data-google-lang=nl class=language__img>ðŸ‡³ðŸ‡±</a>
<a href=# alt=ZH data-google-lang=zh-CN class=language__img>ðŸ‡¨ðŸ‡³</a>
<img src=../../img/ru.png alt=ru data-google-lang=ru class=language__img height=10></div></div></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>Lumi Router JN5169</h1><div class=post-meta><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Jul 7, 2021</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>2 min read</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg><a class=tag href=//xyzroe.cc/tags/lumi/>Lumi</a>
<a class=tag href=//xyzroe.cc/tags/jn5169/>JN5169</a>
<a class=tag href=//xyzroe.cc/tags/zigbee/>Zigbee</a>
<a class=tag href=//xyzroe.cc/tags/diy/>DIY</a></div></div></header><div class=post-content><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin=anonymous><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div># Lumi Router
This is fork of [Lumi Router JN5169 firmware](https://github.com/igo-r/Lumi-Router-JN5169) for use with the LM15-SP-WM module used in the Xiaomi Smart Plug (ZNCZ02LM).
Also it can be used with any other JN5169 based module.
The only difference is the ability to reset the device using a button on DIO 0.
In the original firmware, all control takes place only through the serial port.
---
## How to flash
1. Download [JN-SW-4107](https://www.nxp.com/downloads/en/software-support/JN-SW-4107.zip) and install
2. Connect using JP1 to your USB-TTL according to table below:
LM15-SP-WM (JP1) | JN5169 | Function | USB-TTL
--- | --- | --- | ---
1 | DIO 28 | TXD0 | RX
2 | DIO 29 | RXD0 | TX
3 |DIO 22 | SPIMISO | GND
4 |DIO 9/39 | VDD | 3.3V
5 |DIO 3 | RESETN | ---
6 |DIO 21/39 | VSS | GND
3. Download firmware binary to `C:\NXP\ProductionFlashProgrammer` and open console at this folder.
4. Run `JN51xxProgrammer.exe -s COM1 -f LumiRouter_20210707.bin -v -V`
---
## Reset and join
The device enters join mode in two cases:
1. When PDM memory is erased
2. Right after leaving existing network
Long (> 2000ms) clicking on BTN (DIO0 to GND) erases PDM memory.
The device will restart and then automatically join.
![](https://raw.githubusercontent.com/xyzroe/Lumi-Router-JN5169/master/images/z2m.png)
## Restart
Close JP1_5 (DIO 3) on GND to restart device.
---
### Small prehistory
Some time ago I found such modules based on JNN5169 on TaoBao and ordered a couple.
![](https://raw.githubusercontent.com/xyzroe/Lumi-Router-JN5169/master/images/taobao.jpg)
Initially, I planned to use them as development boards to learn and play Zigbee SDK by NXP. I soldered just such a comb for easy installation into a breadboard.
![](https://raw.githubusercontent.com/xyzroe/Lumi-Router-JN5169/master/images/module.jpeg)
But since they are not very convenient as a development board, it was decided to make routers out of them to expand the Zigbee network.
---
### Making
![](https://raw.githubusercontent.com/xyzroe/Lumi-Router-JN5169/master/images/start.jpeg)
![](https://raw.githubusercontent.com/xyzroe/Lumi-Router-JN5169/master/images/back_side.jpeg)
![](https://raw.githubusercontent.com/xyzroe/Lumi-Router-JN5169/master/images/finish.jpeg)
![](https://raw.githubusercontent.com/xyzroe/Lumi-Router-JN5169/master/images/installed.jpeg)
---
## Thanks and links
[Original Lumi Router JN5169 firmware](https://github.com/igo-r/Lumi-Router-JN5169) by [Igor Listopad](https://github.com/igo-r)
Lots of info about LM15-SP-WM thanks to [@AFaron0v](https://t.me/AFaron0v)
[Xiaomi Zigbee (1): Getting to know the hardware](https://alephsecurity.com/2019/07/01/xiaomi-zigbee-1/)
by Lev Aronsky [@levaronsky](https://twitter.com/levaronsky)
[Hello NXP JN5169 World](https://habr.com/ru/post/547374/) by Oleksandr Masliuchenko [@grafalex82](https://t.me/grafalex82)
[Comment 22819072](https://habr.com/ru/post/547374/#comment_22819072) thanks to [@mrG1K](https://t.me/mrG1K)</div><div class=post-footer></div></article></main><script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script><script src=../../js/load-photoswipe.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin=anonymous></script><script>feather.replace()</script></body></html>