<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Doorphone opener Zintercom | xyzroe's blog</title><meta name=description content=" Board v2 available at GitHub Today I want to share with you the history of the development of a device for controlling a multi-apartment intercom using the â€¦"><meta property="og:title" content="Doorphone opener Zintercom | xyzroe's blog"><meta property="og:description" content=" Board v2 available at GitHub Today I want to share with you the history of the development of a device for controlling a multi-apartment intercom using the â€¦"><meta property="og:type" content="article"><meta property="og:url" content="/posts/zintercom/"><meta property="og:site_name" content="xyzroe's blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Doorphone opener Zintercom | xyzroe's blog"><meta name=twitter:description content=" Board v2 available at GitHub Today I want to share with you the history of the development of a device for controlling a multi-apartment intercom using the â€¦"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","name":"Doorphone opener Zintercom | xyzroe\u0027s blog","url":"\/posts\/zintercom\/","headline":"Doorphone opener Zintercom","datePublished":"2021-02-15T00:00:00Z","author":{"@type":"Person","name":"xyzroe"}}</script><link rel=stylesheet href=/scss/main.min.1d1fe03b396532170236a6ca8173c8391e4fa34f887c1157456e848138ce997d.css integrity="sha256-HR/gOzllMhcCNqbKgXPIOR5Po0+IfBFXRW6EgTjOmX0="><script src=/js/main.min.f6ca1ba1f6d8ce1ff00e4297e1c18f2d5bab853850f82c9d5419deb26fa3c893.js integrity="sha256-9sobofbYzh/wDkKX4cGPLVurhThQ+CydVBnesm+jyJM=" defer></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-5JP6L4L4DL"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-5JP6L4L4DL")</script><link rel=icon type=image/png href=/img/favicon-96x96.png sizes=96x96><link rel=icon type=image/svg+xml href=/img/favicon.svg><link rel="shortcut icon" href=/img/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/img/apple-touch-icon.png><meta name=apple-mobile-web-app-title content="xyzroe.cc"><link rel=manifest href=/img/site.webmanifest><link rel=stylesheet href=/css/google-translate.css><link rel=stylesheet href=/css/accordion.css><link rel=stylesheet href=/css/custom.css><script src=https://unpkg.com/feather-icons></script><script src=https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js></script><script src=/js/google-translate.js></script><script src=/js/custom.js></script></head><body><div class=particles id=particles></div><nav role=navigation aria-label="Main navigation"><div class=container><div class=nav-container><a href=/ class=logo aria-label="xyzroe's blog - Home"><img src=/img/logo.png alt="xyzroe's blog">XYZROE</a><ul class=nav-links id=nav-menu><li><a href=/ aria-current=false>Home</a></li><li><a href=/posts/ aria-current=false>Projects</a></li><li><a href=/about/ aria-current=false>About</a></li><li><a href=/social/ aria-current=false>Social</a></li></ul><button class=mobile-menu-btn aria-expanded=false aria-controls=nav-menu aria-label="Toggle navigation menu">â˜°</button><div class=language-selector><div class=flag-icon>ğŸŒ</div><div class=language-list style=display:none><a href=# alt=EN data-google-lang=en class="language__img language__img_active">ğŸ‡¬ğŸ‡§</a>
<a href=# alt=UA data-google-lang=uk class=language__img>ğŸ‡ºğŸ‡¦</a>
<a href=# alt=PL data-google-lang=pl class=language__img>ğŸ‡µğŸ‡±</a>
<a href=# alt=IL data-google-lang=iw class=language__img>ğŸ‡®ğŸ‡±</a>
<a href=# alt=DE data-google-lang=de class=language__img>ğŸ‡©ğŸ‡ª</a>
<a href=# alt=FR data-google-lang=fr class=language__img>ğŸ‡«ğŸ‡·</a>
<a href=# alt=ES data-google-lang=es class=language__img>ğŸ‡ªğŸ‡¸</a>
<a href=# alt=IT data-google-lang=it class=language__img>ğŸ‡®ğŸ‡¹</a>
<a href=# alt=NL data-google-lang=nl class=language__img>ğŸ‡³ğŸ‡±</a>
<a href=# alt=RU data-google-lang=ru class=language__img>ğŸ‡·ğŸ‡º</a>
<a href=# alt=ZH data-google-lang=zh-CN class=language__img>ğŸ‡¨ğŸ‡³</a></div></div></div></div></nav><main id=main role=main><div class=about-container><article class=about-content><div class=terminal-header><div class=terminal-buttons><span class=btn-close></span>
<span class=btn-minimize></span>
<span class=btn-maximize></span></div><div class=terminal-title>Doorphone opener Zintercom.md</div></div><div class=terminal-body><div class=prompt-line><span class=prompt>$</span>
<span class=command>cat doorphone opener zintercom.md</span></div><div class=content><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin=anonymous><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><h4 id=board-v2-available-at-github-hahahugoshortcode18s1hbhb>Board v2 available at <a href=https://github.com/diyruz/Zintercom/>GitHub</a>
<a href=https://github.com/diyruz/Zintercom/><i data-feather=github stroke-width=2 width=24 height=24 color style=position:relative;top:10px></i>
<span class=screen-reader-text></span></a></h4><p>Today I want to share with you the history of the development of a device for controlling a multi-apartment intercom using the Zigbee protocol.</p><p>Once upon a time I had an automatic doorphone opener based on: ESP8266, a module for two relays (16A) and a transistor with a strapping.</p><p>All this was collected on a bunch of wires and snot made of hot melt glue and looked something like the second photo.<div class="gallery caption-position-bottom caption-effect-slide hover-effect-zoom hover-transition" itemscope itemtype=http://schema.org/ImageGallery><link rel=stylesheet href=/css/hugo-easy-gallery.css><div class=box><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(v1/photos.jpg)><img itemprop=thumbnail src=v1/photos.jpg alt=Zintercom></div><a href=v1/photos.jpg itemprop=contentUrl></a><figcaption><p>Zintercom</p></figcaption></figure></div><div class=box><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(v1/phone.jpg)><img itemprop=thumbnail src=v1/phone.jpg alt="My intercom phone"></div><a href=v1/phone.jpg itemprop=contentUrl></a><figcaption><p>My intercom phone</p></figcaption></figure></div><div class=box><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(v1/esp.jpg)><img itemprop=thumbnail src=v1/esp.jpg alt="Relay module and transistor in the socket behind the tube"></div><a href=v1/esp.jpg itemprop=contentUrl></a><figcaption><p>Relay module and transistor in the socket behind the tube</p></figcaption></figure></div></div></p><p>After organizing a Zigbee network at home, there was a desire to transfer as many devices as possible from to Zigbee in order to unload the Wi-Fi network (now there are 32 devices on Zigbee, and 20 devices on Wi-Fi).</p><p>Inspired by Jager devices and Anonymous firmware, it was decided to make an intercom opener on Zigbee. Surfing the vastness of the network, I came across a project of a similar doorphone opener, authored by Alexander Vaidurov.</p><p>I really liked the idea of â€‹â€‹using optocouplers instead of relays and the option of battery power supply for the device. With his consent, it was decided to use the part of the circuit responsible for working with the intercom line, but to make the control on the CC2530 chip.</p><p>The following scheme turned out:</p><div class=box style=max-width:90%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=v1/Schematic_Zintercom.png></div><a href=v1/Schematic_Zintercom.png itemprop=contentUrl></a></figure></div><p>Then I spread the board and ordered it from the Chinese.<div class=box style=max-width:45%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=v1/dimensions.png></div><a href=v1/dimensions.png itemprop=contentUrl></a></figure></div></p><p>I wanted to place an order before the holidays, and hastened. As a result, there were a couple of small mistakes that had to be corrected with jumpers.</p><p>(Don&rsquo;t rush! Don&rsquo;t repeat my mistakes)</p><p>There was also a discount coupon - decided to try a surface mount order. It turned out about $ 18. (This is more of a curiosity than a real need - the soldering is very simple)</p><p><div class="box fancy-figure caption-position-bottom" style=max-width:45%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=v1/jlcpcb_order.jpg alt="Received boards"></div><a href=v1/jlcpcb_order.jpg itemprop=contentUrl></a><figcaption><p>Received boards</p></figcaption></figure></div><div class="box fancy-figure caption-position-bottom" style=max-width:20%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=v1/jlcpcb_brelok.jpg alt="and a gift"></div><a href=v1/jlcpcb_brelok.jpg itemprop=contentUrl></a><figcaption><p>and a gift</p></figcaption></figure></div></p><p>While the boards were being manufactured and driving, the firmware for the device was written and a converter for zigbee2mqtt was made.</p><p>Dashboard zigbee2mqtt<div class=box style=max-width:45%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=v1/z2m_dashboard.gif></div><a href=v1/z2m_dashboard.gif itemprop=contentUrl></a></figure></div>Exposes zigbee2mqtt<div class=box style=max-width:75%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=v1/z2m_exposes.png></div><a href=v1/z2m_exposes.png itemprop=contentUrl></a></figure></div>In total, what opportunities do we have:</p><ul><li><p>Receive notification when the intercom rings (OnOff direct binding is also supported)</p></li><li><p>Do not interfere with the intercom (Never mode)</p></li><li><p>Automatically open to everyone (Always mode)</p></li><li><p>Open the door once during a call, or at the first call after switching on (Once mode)</p></li><li><p>Dump all incoming (Drop mode)</p></li><li><p>Mute the sound on the intercom handset (or use it without a handset at all)</p></li></ul><p>Call time, waiting time, opening time and report sending interval are configured through exposes.</p><p>For debugging, a second-hand semi-working set of the digital outdoor panel and the Vizit handset was purchased for symbolic money (about $ 15)</p><p>Video demonstrating different operating modes (1.5X)</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src="https://player.vimeo.com/video/537687929?dnt=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allow=fullscreen></iframe></div><p>In the course of debugging and testing, there were some changes:</p><p>Some resistors and capacitors have been changed
Fixed a couple of bugs in the PCB layout
Removed space for 2032 (change too often)
Removed micro USB connector (too inconvenient soldering)<div class=box style=max-width:70%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=v1/usb.jpg></div><a href=v1/usb.jpg itemprop=contentUrl></a></figure></div>Final renders</p><div class="gallery caption-position-bottom caption-effect-slide hover-effect-zoom hover-transition" itemscope itemtype=http://schema.org/ImageGallery><div class=box><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(v1/front_side.png)><img itemprop=thumbnail src=v1/front_side.png alt=Front></div><a href=v1/front_side.png itemprop=contentUrl></a><figcaption><p>Front</p></figcaption></figure></div><div class=box><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(v1/back_DC_5-9V.png)><img itemprop=thumbnail src=v1/back_DC_5-9V.png alt="Back 5-9V"></div><a href=v1/back_DC_5-9V.png itemprop=contentUrl></a><figcaption><p>Back 5-9V</p></figcaption></figure></div><div class=box><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(v1/back_2xAAA.png)><img itemprop=thumbnail src=v1/back_2xAAA.png alt="Back 2 * AAA holder"></div><a href=v1/back_2xAAA.png itemprop=contentUrl></a><figcaption><p>Back 2 * AAA holder</p></figcaption></figure></div></div><p>Differences between constant and battery power supply:</p><p>With constant:</p><p>Interval for sending reports - 1 minute
Battery status is not sent
Router or end device mode</p><p>With battery (E18-MS1-PCB only):</p><p>Interval for sending reports - 30 minutes
Battery status is sent after every event (call / button press)
End device mode only
Since the device is in sleep mode, it cannot receive commands, but it is possible to change the mode with a button or Zigbee command at the time of a call.</p><p>Do not turn off the sound, because it keeps the U2 on all the time, which drains the battery much faster.
If any commands are in the coordinator&rsquo;s queue, they will be executed when the device wakes up - after pressing a button or after receiving an incoming one.</p><p>After all the tests, I installed the board in the intercom tube case:</p><div class=box style=max-width:35%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=v1/inside.jpg></div><a href=v1/inside.jpg itemprop=contentUrl></a></figure></div><p>Firmware, diagrams, Gerbers are open and are on the project&rsquo;s <a href=https://github.com/xyzroe/Zintercom/>Github repository</a>
<a href=https://github.com/xyzroe/Zintercom/><i data-feather=github stroke-width=2 width=32 height=30 color style=position:relative;top:10px></i>
<span class=screen-reader-text></span></a></p></div></div></article></div></main><footer style="background:rgba(0,0,0,.3);padding:2rem 0;margin-top:4rem;text-align:center;border-top:1px solid rgba(255,255,255,.1)"><div class=container><p style=color:#888;margin:0>Copyright Â© 2025 â€¢
Made with â™¥ï¸ by <a href=https://github.com/xyzroe target=_blank style=color:#9d50bb;text-decoration:none>xyzroe</a></p></div></footer><script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script><script src=/js/load-photoswipe.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin=anonymous></script><script>feather.replace()</script></body></html>